<!DOCTYPE html>
<head>
	<meta charset='utf-8'>
	<title>Terrain in Maplibre</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel='stylesheet' href='https://unpkg.com/maplibre-gl@5.7.3/dist/maplibre-gl.css' />
	<script src='https://unpkg.com/maplibre-gl@5.7.3/dist/maplibre-gl.js'></script>
	<style>
		body {
			margin: 0;
			padding: 0;
		}
		html,
		body,
		#map {
			height: 100%;
		}
		#picker {
			position: fixed;
			top: 0px;
			left: 0px;
			z-index: 50;
		}
		.red {
			background-color: rgb(255, 150, 150);
		}
		.yellow {
			background-color: rgb(255, 255, 150);
		}
		.green {
			background-color: rgb(150, 255, 150);
		}
		.white {
			background-color: white;
		}
	</style>
</head>

<body>
	<div id="picker">
		<h1 class="startupOnly">Choose a map:</h1>
		<table>
			<tr class="startupOnly">
				<td>With terrain:</td>
				<td></td>
			</tr>
			<tr>
				<td><button class="red" onclick="changeStyle('styles/terrain/ofm-seethrough.style.json')">Background: See-through modified OpenFreeMap</button></td>
				<td class="startupOnly"> - Many vertical artifacts visible</td>
			</tr>
			<tr>
				<td><button class="yellow" onclick="changeStyle('styles/terrain/transparent-with-terrain.style.json')">Background: blank | Overlay: line and polygon</button></td>
				<td class="startupOnly">- Some Vertical artifacts visible</td>
			</tr>
			<tr>
				<td><button class="green" onclick="changeStyle('styles/terrain/osm-with-terrain.style.json')">Background: OSM | Overlay: line and polygon</button></td>
				<td class="startupOnly">- No vertical artifacts visible</td>
			</tr>
			<tr>
				<td><label class="white">No terrain:</label></td>
				<td></td>
			</tr>
			<tr>
				<td><button class="green" onclick="changeStyle('styles/no-terrain/ofm-seethrough.style.json')">Background: See-through modified OpenFreeMap</button></td>
				<td class="startupOnly"> - No vertical artifacts visible</td>
			</tr>
			<tr>
				<td><button class="green" onclick="changeStyle('styles/no-terrain/transparent-with-terrain.style.json')">Background: blank | Overlay: line and polygon</button></td>
				<td class="startupOnly">- No vertical artifacts visible</td>
			</tr>
			<tr>
				<td><button class="green" onclick="changeStyle('styles/no-terrain/osm-with-terrain.style.json')">Background: OSM | Overlay: line and polygon</button></td>
				<td class="startupOnly">- No vertical artifacts visible</td>
			</tr>
		</table>
	</div>
	<div id="map"></div>
	<script>
	let map = null;
	function changeStyle(styleFile) {
		if (!map) {
			map = initMap(styleFile);
		}
		else {
			map.setStyle(styleFile);
		}
	}
	function initMap(styleFile) {
		const map = (window.map = new maplibregl.Map({
			container: 'map',
			zoom: 12,
			center: [11.39085, 47.27574],
			pitch: 70,
			hash: true,
			style: `${styleFile}`, 
			maxZoom: 18,
			maxPitch: 85
		}));

		map.addControl(
			new maplibregl.NavigationControl({
				visualizePitch: true,
				showZoom: true,
				showCompass: true
			})
		);

		map.addControl(
			new maplibregl.TerrainControl({
				source: 'terrainSource',
				exaggeration: 1
			})
		);

		Array.from(document.getElementsByClassName('startupOnly')).forEach((el) => {
			el.remove();
		})
		return map;
	}
	</script>
</body>

</html>